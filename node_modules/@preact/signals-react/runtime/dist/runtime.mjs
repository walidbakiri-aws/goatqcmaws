import{Signal as n,signal as t,computed as e,effect as r}from"@preact/signals-core";import i,{__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED as o,useRef as u,useLayoutEffect as f,useMemo as s,useEffect as c}from"react";import{useSyncExternalStore as l}from"use-sync-external-store/shim/index.js";import a from"react/jsx-runtime";import m from"react/jsx-dev-runtime";let p=!1,d=null,b=!1,v=null;const g=new Map;function h(n){if(!n)return 1;const t=g.get(n);if(void 0!==t)return t;let e;const r=n.useCallback.toString();if(n.useReducer===n.useEffect)e=1;else if(n.useEffect===n.useImperativeHandle)e=32;else if(/Invalid/.test(r))e=2;else if(/updateCallback/.test(r)||/\[0\]/.test(r)&&/\[1\]/.test(r)){let t=n.useReducer.toString();if(/rerenderReducer/.test(t)||/return\s*\[\w+,/.test(t))e=16;else e=8}else e=4;g.set(n,e);return e}function y(){!function(){p=!0;Object.defineProperty(o.ReactCurrentDispatcher,"current",{get:()=>v,set(n){if(b){v=n;return}const t=h(v),e=h(n);v=n;if(function(n,t){if(1&n&&28&t)return!0;else if(2&n||2&t)return!1;else return!1}(t,e)){b=!0;d=R(1);b=!1}else if(function(n,t){return Boolean(28&n&&16&t)}(t,e)){var r;null==(r=d)||r.f();b=!0;d=R(1);b=!1}else if(function(n,t){return Boolean(28&n&&1&t)}(t,e)){var i;null==(i=d)||i.f();d=null}}})}();!function(){const n=a,t=m;i.createElement=x(i.createElement);t.jsx&&(t.jsx=x(t.jsx));n.jsx&&(n.jsx=x(n.jsx));t.jsxs&&(t.jsxs=x(t.jsxs));n.jsxs&&(n.jsxs=x(n.jsxs));t.jsxDEV&&(t.jsxDEV=x(t.jsxDEV));n.jsxDEV&&(n.jsxDEV=x(n.jsxDEV))}()}const _=[],S=Symbol.for("react.element"),j=()=>{};function x(t){if("function"!=typeof t)return t;else return function(e,r,...i){if("string"==typeof e&&r)for(let t in r){let e=r[t];if("children"!==t&&e instanceof n)r[t]=e.value}return t.call(t,e,r,...i)}}const k=Symbol.dispose||Symbol.for("Symbol.dispose");let w;function B(n,t){const e=t.effect.S();w=t;return O.bind(t,n,e)}function O(n,t){t();w=n}const P={o:0,effect:{s:void 0,c(){},S:()=>j,d(){}},subscribe:()=>j,getSnapshot:()=>0,S(){},f(){},[k](){}},$=Promise.prototype.then.bind(Promise.resolve());let C;function I(){if(!C)C=$(M)}function M(){var n;C=void 0;null==(n=w)||n.f()}function R(n=0){I();const t=u();if(null==t.current)t.current=function(n){let t,e,i,o=0,u=r(function(){t=this});t.c=function(){o=o+1|0;if(i)i()};return{o:n,effect:t,subscribe(n){i=n;return function(){o=o+1|0;i=void 0;u()}},getSnapshot:()=>o,S(){if(null==w){e=B(void 0,this);return}const n=w.o,t=this.o;if(0==n&&0==t||0==n&&1==t){w.f();e=B(void 0,this)}else if(1==n&&0==t||2==n&&0==t);else e=B(w,this)},f(){const n=e;e=void 0;null==n||n()},[k](){this.f()}}}(n);const e=t.current;l(e.subscribe,e.getSnapshot,e.getSnapshot);e.S();if(0===n)f(M);return e}Object.defineProperties(n.prototype,{$$typeof:{configurable:!0,value:S},type:{configurable:!0,value:function({data:n}){const t=R(1);try{return n.value}finally{t.f()}}},props:{configurable:!0,get(){return{data:this}}},ref:{configurable:!0,value:null}});function q(n){if(p)return P;else return R(n)}function useSignal(n){return s(()=>t(n),_)}function useComputed(n){const t=u(n);t.current=n;return s(()=>e(()=>t.current()),_)}function useSignalEffect(n){const t=u(n);t.current=n;c(()=>r(()=>t.current()),_)}export{R as _useSignalsImplementation,I as ensureFinalCleanup,y as installAutoSignalTracking,useComputed,useSignal,useSignalEffect,q as useSignals,x as wrapJsx};//# sourceMappingURL=runtime.mjs.map
